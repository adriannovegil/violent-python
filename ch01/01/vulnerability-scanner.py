import socket

# Funcion que se encarga de llevar a cabo la conexion con el servidor.
def retBanner(ip, port):
	try:
		socket.setdefaulttimeout(2)
		s = socket.socket()
		s.connect((ip, port))
		banner = s.recv(1024)
		return banner
	except Exception, e:
		#print "[-] Imposible establecer la conexion con la ip: " + ip + " en el puerto: " + str(port) + ". Error = " + str(e)
		return

# Funcion que se encarga de verificar si existe alguna vulnerabilidad 
# en el servidor.
def checkVulns(banner):
	f = open("vuln_banners.txt",'r')
	for line in f.readlines():
		if line.strip('\n') in banner:
			print '[+] Server is vulnerable:' + banner.strip('\n')
			return
	return

# Funcion principal que inicializa todo el proceso.
def main():
	portList = [21,22,25,80,110,443]
	for x in range(231,255):
		ip = '192.168.1.' + str(x)
		for port in portList:
			banner = retBanner(ip, port)
			if banner:
				print '[+] ' + ip + ':' + str(port) + ' = ' + banner
				checkVulns(banner)

# Llamada a la funcion principal
if __name__ == '__main__':
	main()